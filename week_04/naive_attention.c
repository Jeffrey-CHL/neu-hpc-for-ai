// (same as before, baseline implementation)
